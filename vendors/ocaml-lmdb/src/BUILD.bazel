load("@obazl_rules_ocaml//dsl:library.bzl", "lib", "mod", "sig")

cc_library(
    name = "lmdb_c",
    srcs = [
        ":lmdb.h",
        ":lmdb_stubs.c",
        ":mdb.c",
        ":midl.h",
        ":midl.c",
    ],
    deps = [
        "@opam_libs//:ocaml",
    ],
)

lib(
    name = "tezos-lmdb",
    modules = dict(
        lmdb = sig(mod_kw = dict(cc_deps = { ":lmdb_c": "default" })),
    ),
    deps_opam = [
        "rresult",
    ],
)
